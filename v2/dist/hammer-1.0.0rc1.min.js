/*! Hammer.JS - v1.0.0rc1 - 2013-01-31
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2013 Jorik Tangelder <jorik@eight.nl>;
 * Licensed under the MIT license */

(function(e){"use strict";function t(){if(!n.READY){n.event.determineEventTypes();for(var t in n.gestures)n.gestures.hasOwnProperty(t)&&n.gesture.register(n.gestures[t]);n.event.onTouch(e,n.TOUCH_MOVE,n.gesture.detect),n.event.onTouch(e,n.TOUCH_END,n.gesture.endDetect),n.READY=!0}}var n=function(e,t){return new n.Instance(e,t||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchCallout:"none",touchAction:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=e.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in e,n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.TOUCH_START="start",n.TOUCH_MOVE="move",n.TOUCH_END="end",n.plugins={},n.READY=!1,n.Instance=function(e,r){var i=this;return t(),this.element=e,this._events={},this.options=n.utils.extend(n.utils.extend({},n.defaults),r||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this),n.event.onTouch(e,n.TOUCH_START,function(e){return n.gesture.startDetect(i,e)}),this},n.Instance.prototype={on:function(e,t){var n,r;for(e=e.split(" "),r=0;e.length>r;r++)n=e[r],this._events[n]=this._events[n]||[],this._events[n].push(t)},off:function(e,t){var n,r;for(e=e.split(" "),r=0;e.length>r;r++){if(n=e[r],n in this._events==!1)return;this._events[n].splice(this._events[n].indexOf(t),1)}},trigger:function(e,t){if(t.gesture=e,e in this._events!=!1)for(var n=0;this._events[e].length>n;n++)this._events[e][n].call(this,t)}};var r={},i=!1;n.event={bindDom:function(e,t,n){t=t.split(" ");for(var r=0;t.length>r;r++)e.addEventListener(t[r],n,!1)},onTouch:function(e,t,s){var a=this,o=function(i){n.HAS_POINTEREVENTS&&n.PointerEvent.updatePointer(t,i),t===n.TOUCH_END?i=r:r=i,s.call(this,a.collectEventData(e,t,i))};n.HAS_TOUCHEVENTS||n.HAS_POINTEREVENTS?this.bindDom(e,n.EVENT_TYPES[t],o):this.bindDom(e,n.EVENT_TYPES[t],function(e){(1===e.which||1===e.button)&&(i=!0,o.apply(this,arguments)),"mouseup"==e.type&&(i=!1)})},determineEventTypes:function(){var e;e=n.HAS_POINTEREVENTS?["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel"]:n.HAS_TOUCHEVENTS?["touchstart","touchmove","touchend touchcancel"]:["mousedown","mousemove","mouseup"],n.EVENT_TYPES[n.TOUCH_START]=e[0],n.EVENT_TYPES[n.TOUCH_MOVE]=e[1],n.EVENT_TYPES[n.TOUCH_END]=e[2]},getTouchList:function(e){return n.HAS_POINTEREVENTS?n.PointerEvent.getPointers():n.HAS_TOUCHEVENTS?e.touches:[{identifier:1,pageX:e.pageX,pageY:e.pageY,target:e.target}]},collectEventData:function(e,t,r){var i=this.getTouchList(r,t);return{type:t,time:(new Date).getTime(),target:r.target,touches:i,srcEvent:r,center:n.utils.getCenter(i),preventDefault:function(){return r.preventDefault()}}}};var s=Math.PI;n.utils={extend:function(e,t,n){n=n||0;for(var r in t)t.hasOwnProperty(r)&&(e[r]=n&&"object"==typeof t[r]?this.extend({},t[r],n-1):t[r]);return e},fastAbs:function(e){return(e^e>>31)-(e>>31)},getCenter:function(e){for(var t=[],n=[],r=0,i=e.length;i>r;r++)t.push(e[r].pageX),n.push(e[r].pageY);return{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2}},getSimpleDistance:function(e,t){return this.fastAbs(t-e)},getAngle:function(e,t){var n=t.pageY-e.pageY,r=t.pageX-e.pageX;return 180*Math.atan2(n,r)/s},getDirection:function(e,t){var r=this.fastAbs(e.pageX-t.pageX),i=this.fastAbs(e.pageY-t.pageY);return r>=i?e.pageX-t.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:e.pageY-t.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(e,t){var n=t.pageX-e.pageX,r=t.pageY-e.pageY;return Math.sqrt(n*n+r*r)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return 2==e.length&&2==t.length?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},stopDefaultBrowserBehavior:function(e){var t,n=["webkit","khtml","moz","ms","o",""],r=e.options.stop_browser_behavior;if(r){for(var i=0;n.length>i;i++)for(var s in r)r.hasOwnProperty(s)&&(t=s,n[i]&&(t=n[i]+t.substring(0,1).toUpperCase()+t.substring(1)),e.element.style[t]=r[s]);"none"==r.userSelect&&(e.element.onselectstart=function(){return!1})}}},n.gesture={gestures:[],current:null,previous:null,startDetect:function(e,t){var r=n.gesture;if(!r.current)return r.current={inst:e,startEvent:n.utils.extend({},t),lastEvent:!1,name:""},r.detect(t)},detect:function(e){var t,r=n.gesture;if(r.current){for(var i=r.extendEventData(e),s=r.current.inst.options,a=0,o=r.gestures.length;o>a;a++){var u=r.gestures[a];if(s[u.name]!==!1&&(t=u.handler.call(u,i.type,i,r.current.inst),t===!1)){r.stop();break}}r.current.lastEvent=i}},endDetect:function(e){var t=n.gesture;t.detect(e),t.stop()},stop:function(){this.previous=n.utils.extend({},this.current),this.current=null},extendEventData:function(e){var t=this.current.startEvent;return t&&e.touches.length!=t.touches.length&&(t.touches=n.utils.extend({},e.touches,1)),n.utils.extend(e,{touchTime:e.time-t.time,angle:n.utils.getAngle(t.center,e.center),direction:n.utils.getDirection(t.center,e.center),distance:n.utils.getDistance(t.center,e.center),distanceX:n.utils.getSimpleDistance(t.center.pageX,e.center.pageX),distanceY:n.utils.getSimpleDistance(t.center.pageY,e.center.pageY),scale:n.utils.getScale(t.touches,e.touches),rotation:n.utils.getRotation(t.touches,e.touches),startEvent:t}),e},register:function(e){var t=e.defaults||{};t[e.name]===undefined&&(t[e.name]=!0),n.utils.extend(n.defaults,t),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0})}},n.gestures=n.gestures||{},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500},timer:null,handler:function(e,t,r){switch(e){case n.TOUCH_START:var i=this;clearTimeout(this.timer),n.gesture.current.name=this.name,this.timer=setTimeout(function(){n.gesture.current.name==i.name&&r.trigger(i.name,t)},r.options.hold_timeout);break;case n.TOUCH_MOVE:case n.TOUCH_END:clearTimeout(this.timer)}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,doubletap_distance:20,doubletap_interval:300},handler:function(e,t,r){if(e==n.TOUCH_END){var i=n.gesture.previous;if(t.touchTime>r.options.tap_max_touchtime||t.distance>r.options.tap_max_distance)return;n.gesture.current.name=i&&"tap"==i.name&&t.time-i.lastEvent.time<r.options.doubletap_interval&&t.distance<r.options.doubletap_distance?"doubletap":"tap",r.trigger(n.gesture.current.name,t)}}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1},handler:function(e,t,r){if(!(r.options.drag_max_touches>0&&t.touches.length>r.options.drag_max_touches)&&e==n.TOUCH_MOVE){if(t.distance<r.options.drag_min_distance&&n.gesture.current.name!=this.name)return;n.gesture.current.name=this.name,r.trigger(this.name,t),r.trigger(this.name+t.direction,t),(r.options.drag_block_vertical&&(t.direction==n.DIRECTION_UP||t.direction==n.DIRECTION_DOWN)||r.options.drag_block_horizontal&&(t.direction==n.DIRECTION_LEFT||t.direction==n.DIRECTION_RIGHT))&&t.preventDefault()}}},n.gestures.Swipe={name:"swipe",index:51,defaults:{swipe_min_time:150,swipe_max_time:500,swipe_min_distance:30},handler:function(e,t,r){e==n.TOUCH_END&&"drag"==n.gesture.current.name&&t.touchTime>r.options.swipe_min_time&&t.touchTime<r.options.swipe_max_time&&t.distance>r.options.swipe_min_distance&&(r.trigger(this.name,t),r.trigger(this.name+t.direction,t))}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},handler:function(e,t,r){if(r.options.transform_always_block&&2==t.touches.length&&t.preventDefault(),e==n.TOUCH_MOVE&&2==t.touches.length){var i=Math.abs(1-t.scale),s=Math.abs(t.rotation);if(r.options.transform_min_scale>i&&r.options.transform_min_rotation>s)return;n.gesture.current.name=this.name,r.trigger(this.name,t),s>r.options.transform_min_rotation&&r.trigger("rotate",t),i>r.options.transform_min_scale&&(r.trigger("pinch",t),r.trigger("pinch"+(1>t.scale?"in":"out"),t))}}},n.gestures.Touch={name:"touch",index:-1/0,handler:function(e,t,r){e==n.TOUCH_START&&r.trigger(this.name,t)}},n.gestures.Release={name:"release",index:1/0,handler:function(e,t,r){e==n.TOUCH_END&&r.trigger(this.name,t)}},e.Hammer=n})(window);